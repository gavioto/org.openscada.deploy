<?xml version="1.0" encoding="UTF-8"?>

<project name="customAssembly" default="default">
	
	<property name="gather.base" location="modules/org.openscada.p2.repo.main"/>
	
	<!-- ================================= 
          target: default              
         ================================= -->
    <target name="default" description="Gather resources">
    	<mkdir dir="${gather.base}/repos"/>
		<copy todir="${gather.base}/repos">
			<fileset dir="${input.dir}/repos">
				<include name="*-p2repo.zip"/>
			</fileset>
    	</copy>
        <unpackRepo name="org.openscada.external" version="${external.version}"/>
        <unpackRepo name="org.openscada.jinterop" version="${jinterop.version}"/>
        <unpackRepo name="org.openscada.utgard" version="${utgard.version}"/>
        <unpackRepo name="org.openscada.atlantis" version="${atlantis.version}"/>
    </target>
        
	<!-- = = = = = = = = = = = = = = = = =
          macrodef: unpackRepo          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="unpackRepo">
        <attribute name="name" />
        <attribute name="version" />
        <sequential>
            <mkdir dir="${gather.base}/repos/@{name}"/>
            <unzip dest="${gather.base}/repos/@{name}" src="${input.dir}/repos/@{name}.sdk-@{version}-p2repo.zip">
        	</unzip>
        </sequential>
    </macrodef>


</project>
